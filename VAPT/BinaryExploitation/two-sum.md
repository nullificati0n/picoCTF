### ![picoctf](https://play.picoctf.org/static/media/picoctf-logo-horizontal-white.17fdf0dcdef08dc3396a195b95e3bc29.svg) 
## picoCTF Binary Exploitation: two-sum
# Educational Code Analysis Report
### **Title:** Understanding Integer Overflow in Code

**Date:** 05/09/2023

**Author:** [nullificati0n](https://github.com/nullificati0n/)

### Executive Summary

This educational code analysis report aims to provide insights into integer overflow scenarios within a C code snippet. The code is intentionally designed to demonstrate integer overflow situations when adding two integers (`num1` and `num2`) and is intended to enhance users' understanding of overflow conditions.

### Code Description

**Code Name:** Integer Overflow Demonstration

**Objective:** Educational

**Code Overview:** The provided code includes a function called `addIntOvf` that checks for integer overflow when adding two integers. The main purpose of this code is to showcase integer overflow scenarios and not to address any security vulnerabilities.
```c
#include <stdio.h>
#include <stdlib.h>

static int addIntOvf(int result, int a, int b) {
    result = a + b;
    if(a > 0 && b > 0 && result < 0)
        return -1;
    if(a < 0 && b < 0 && result > 0)
        return -1;
    return 0;
}

int main() {
    int num1, num2, sum;
    FILE *flag;
    char c;

    printf("n1 > n1 + n2 OR n2 > n1 + n2 \n");
    fflush(stdout);
    printf("What two positive numbers can make this possible: \n");
    fflush(stdout);
    
    if (scanf("%d", &num1) && scanf("%d", &num2)) {
        printf("You entered %d and %d\n", num1, num2);
        fflush(stdout);
        sum = num1 + num2;
        if (addIntOvf(sum, num1, num2) == 0) {
            printf("No overflow\n");
            fflush(stdout);
            exit(0);
        } else if (addIntOvf(sum, num1, num2) == -1) {
            printf("You have an integer overflow\n");
            fflush(stdout);
        }

        if (num1 > 0 || num2 > 0) {
            flag = fopen("flag.txt","r");
            if(flag == NULL){
                printf("flag not found: please run this on the server\n");
                fflush(stdout);
                exit(0);
            }
            char buf[60];
            fgets(buf, 59, flag);
            printf("YOUR FLAG IS: %s\n", buf);
            fflush(stdout);
            exit(0);
        }
    }
    return 0;
}

```
### Demonstration

**Demonstration Name:** Triggering Integer Overflow

**Scenario:** Understanding Integer Overflow

**Description:** The demonstration involves inputting the value `2147483647` for both `num1` and `num2` and observing how the code handles this situation.

1. `num1` and `num2` both receive the value `2147483647`.

2. The program calculates the sum `sum = num1 + num2`, resulting in `4294967294`.

3. The `addIntOvf` function is called with `result` set to `4294967294`, `a` set to `2147483647`, and `b` set to `2147483647`.

4. The function checks the conditions:
   - `a > 0` is true because `2147483647` is greater than `0`.
   - `b > 0` is true for the same reason.
   - `result < 0` is true because `4294967294` is greater than the maximum representable value for a signed 32-bit integer, causing an overflow.

5. As a result, the `addIntOvf` function returns `-1`, indicating an integer overflow.

6. The `main` function then detects this overflow condition and prints "You have an integer overflow."

### Conclusion

This code serves as an educational tool to illustrate the concept of integer overflow in programming. It is not intended to address security vulnerabilities or promote malicious actions. Understanding integer overflow is crucial for secure coding practices and the proper handling of edge cases in real-world applications.
